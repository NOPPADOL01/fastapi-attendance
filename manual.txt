VI、Accessories
《Device control and command》
Realize remote control function when server sends the command to the device. When
this command is through device to actively get the request from the server, device will
get command from the server, and then execute this command, and return the result to
the server again.
1, Fixed-time request and its command formart from device to server
URL path format: GET http://host/iclock/getrequest?SN=xxxx
Thereinto, http://host/iclock/ indicates the web applied path, xxxx indicates the
serial number of device itself.
This request is sent from device to server per fixed time, is used to get the
command that the server gives to itself. Then the server returns command format to the
device, shown as:
C:ID1:CMD1
C:ID2:CMD2
C:ID3:CMD3
Multiple commands can be divided into multiple rows, thereinto each row starts
with “C:”, the following ID indicates the serial number of this comand (generated by the
server, the number of current given command must be unique), CMD indicates the detail
content of command.
After executing these commands, device will return the result to the server through the following
URL
POST /iclock/devicecmd?SN=xxxxxx
Thereinto pose’s content includes the returned content.
Note: When device requests command from the server for the first time, or the device enrolls a
new user/fingerprint and there is a new attendance record, URL path format will include simple
infomration items (INFO=firmware version number, enrolled user number, enrolled fingerprint
number, attendance record number, and IP address of the attendance device):
GET http://host/iclock/getrequest?SN=xxxx&INFO=Ver 6.39 Apr 28
2008,2,0,0,192.168.1.201
2, Command from server to device
1. Execute system command
Format:
SHELL CMD_String
Return:
POST’s content is ID=iiii&SN=xxxx&Return=vvvv&Content=ssss, thereinto vvvv is
the returned value of system command; ssss is the output content after command
executing.
2. Check data refresh
Format:
CHECK
Function:
Get device’s configuration information from server, then check the data’s refreshing situation
in the device, if there is a new data, transmit to the server immediately;
Return:
POST’s content is ID=iiii&SN=xxxx&Return=1 
3. Clear data
Format:
CLEAR LOG
Function:
Clear attendance record
Format:
CLEAR DATA
Function:
Clear all data
4. send device’s information to the server 
Format:
INFO
Return:
POST’s content is the effective content of system’s all configurations and items.
5. set device’s item
Format:
SET OPTION ITEM=VALUE
Thereinto ITEM is the item’s conetent, VALUE is the item’s value. At current, only
items with no ‘~’start are supported, for example:
SET OPTION IPAddress=192.168.1.225
Set IP address of device as 192.168.1.225.
Return:
Post’s content is ID=iiii&SN=xxxx&Return=0
6. Restart
Format:
REBOOT
Function:
Restart the device
Note:
This command must be the last command returned to the device. 
7. Data command
Format:
DATA SUBCMD
SUBCMD is as the following sub-command
%s : format character string
%d : formatted value
\t ：tab
1) add or modify the user information
USER
PIN=%d\tName=%s\tPri=%d\tPasswd=%s\tCard=[%02x%02x%02x%02x%02x]\tGrp=%d\t
TZ=%d
Only PIN field is a must in this command, other fields can be none
2) add or modify the user fingerprint
FP PIN=%d\tFID=%d\tSize=%d\tValid=%d\tTMP=%s
3) delete the user
DEL_USER PIN=%d
4) delete the user fingerprint
DEL_FP PIN=%d\tFID=%d
8. reload system item
Format:
RELOAD OPTIONS
Function:
Require device to reload system configurations and items, so the modified system items can
take affect.